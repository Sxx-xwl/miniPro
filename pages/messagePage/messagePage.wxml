<!--pages/messagePage/messagePage.wxml-->
<!-- é¡¶éƒ¨é€šçŸ¥æ  -->
<van-notice-bar color="#1989fa" background="#ecf9ff" left-icon="phone" class="notice">
  åˆ«çæ‰¯å¥¥ï¼ä½ å·²ç»è¿›å…¥ç½‘è­¦çš„ç›‘æ§èŒƒå›´äº†ï¼ğŸ‘€
</van-notice-bar>

<!-- ç•™è¨€åˆ—è¡¨ -->
<view class="messageList">
  <scroll-view scroll-y="true" class="list">
    <view class="list-scroll-view">
      <block class="commentsBlock" wx:for="{{list}}" wx:key="index">

        <view class="commentsInfo" wx:if="{{item.comments||item.cloudPath}}">
          <view class="commentPart1">
            <van-image round width="2rem" height="2rem" src="{{item.portrait}}" />
            <view class="commentName">{{item.userName}}</view>
          </view>
          <view class="commentPart2">
            <view class="commentPart3" wx:if="{{openid=='oZLHV4lqw6nzzt_1Z7I1A8PgR8-s'}}">
              <!-- é•¿æŒ‰ä¿®æ”¹ -->
              <view class="comment" data-id="{{item._id}}" data-comments="{{item.comments}}" bindlongpress="updateCom" 
              data-openid="{{item._openid}}" wx:if="{{item.comments}}">{{item.comments}}</view>
              <van-image class="img" width="5rem" height="5rem" fit="contain" wx:if="{{item.cloudPath}}" src="{{item.cloudPath}}" />
            </view>
            <view class="commentPart3" wx:if="{{openid=='oZLHV4n8chsAEruzEztUEUaCXB_Q'}}">
              <!-- é•¿æŒ‰ä¿®æ”¹ -->
              <view class="comment" data-id="{{item._id}}" data-comments="{{item.comments}}" bindlongpress="updateCom" 
              data-cloudPath="{{item.cloudPath}}" data-openid="{{item._openid}}" wx:if="{{item.comments}}">{{item.comments}}</view>
              <!-- é•¿æŒ‰åˆ é™¤ -->
              <van-image class="img" width="5rem" data-id="{{item._id}}" height="5rem" fit="contain" wx:if="{{item.cloudPath}}" 
              data-cloudPath="{{item.cloudPath}}" bindlongpress="deleteImg" src="{{item.cloudPath}}" />
            </view>
            <view class="commentPart3" wx:if="{{openid!='oZLHV4lqw6nzzt_1Z7I1A8PgR8-s' && openid!='oZLHV4n8chsAEruzEztUEUaCXB_Q'}}">
              <!-- é•¿æŒ‰ä¿®æ”¹ -->
              <view class="comment" wx:if="{{item.comments}}">{{item.comments}}</view>
              <van-image class="img" width="5rem" height="5rem" fit="contain" wx:if="{{item.cloudPath}}" src="{{item.cloudPath}}" />
            </view>
            <view class="commentData">{{item.submitTime}}</view>
          </view>
        </view>
        <view class="divider" wx:if="{{item.comments||item.cloudPath}}"></view>

      </block>
    </view>
  </scroll-view>
</view>

<!-- ç•™è¨€åŒºåŸŸ -->
<view class="messagePanelParent">
  <van-cell-group inset class="messagePanel">
    <van-field bind:change='onChange' value="{{ comments }}" rows="2" left-icon="comment" right-icon="info-o" label="ç•™è¨€æ¿ï¼š" type="textarea" maxlength="49" placeholder="ä½ æƒ³è·Ÿå¤§å®¶è¯´ç‚¹å•¥ï¼Ÿï¼Ÿï¼Ÿ" show-word-limit />
    <van-cell>
      <van-button icon="smile-o" round size="small" type="primary" bindtap="chooseImg">æ–—å›¾</van-button>
      <van-button icon="volume-o" type="info" size="small" round bindtap="addComments">å‘é€</van-button>
    </van-cell>
  </van-cell-group>
</view>

<!-- åˆ é™¤å›¾ç‰‡çª—å£ -->
<van-overlay show="{{ show1 }}">
  <view class="wrapper">
    <view class="block">
      <view class="but">
        <view>
          <van-button color="#272643" plain bindtap="onClickHide">å–æ¶ˆ</van-button>
        </view>
        <view>
          <van-button color="#f66fb9" plain bindtap="delete">åˆ é™¤</van-button>
        </view>
      </view>
    </view>
  </view>
</van-overlay>
<!-- ä¿®æ”¹ç•™è¨€çª—å£ -->
<van-overlay show="{{ show }}">
  <view class="wrapper">
    <view class="block">
      <van-field class="text" bind:change='comInput' value="{{ selectCom }}" title-width='3em'
      left-icon="comment" autosize label="å†…å®¹:" type="textarea" maxlength="49"  show-word-limit />
      <view class="but">
        <view>
          <van-button color="#272643" plain bindtap="onClickHide">å–æ¶ˆ</van-button>
        </view>
        <view>
          <van-button color="#f66fb9" plain bindtap="update">ä¿®æ”¹</van-button>
        </view>
      </view>
    </view>
  </view>
</van-overlay>

<!-- ç¡®è®¤çª—å£ -->
<van-dialog id="van-dialog" />